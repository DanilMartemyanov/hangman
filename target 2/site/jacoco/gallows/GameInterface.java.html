<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GameInterface.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">java</a> &gt; <a href="index.source.html" class="el_package">gallows</a> &gt; <span class="el_source">GameInterface.java</span></div><h1>GameInterface.java</h1><pre class="source lang-java linenums">package gallows;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintStream;
import java.nio.charset.StandardCharsets;
import java.util.HashMap;
import java.util.NoSuchElementException;
import java.util.regex.Matcher;

@SuppressWarnings(&quot;checkstyle:CyclomaticComplexity&quot;)
<span class="nc" id="L13">public class GameInterface {</span>
<span class="nc" id="L14">    @SuppressWarnings(&quot;checkstyle:ConstantName&quot;)</span>
    private final BufferedReader bufferedReader =
        new BufferedReader(new InputStreamReader(System.in, StandardCharsets.UTF_8));
<span class="nc" id="L17">    private final CheckInputUserImpl checkInputUser = new CheckInputUserImpl();</span>
<span class="nc" id="L18">    private final LogicFindCorrectCharImpl logicFindCorrectChar = new LogicFindCorrectCharImpl();</span>
<span class="nc" id="L19">    private final WordsGallows wordsGallows = new WordsGallows();</span>
<span class="nc" id="L20">    private final PrintStream printStream = new PrintStream(System.out, true, StandardCharsets.UTF_8);</span>

    @SuppressWarnings(&quot;checkstyle:MultipleStringLiterals&quot;)
    public void userInterface() {
        while (true) {
<span class="nc" id="L25">            printStream.println(&quot;------------------------------------------------------&quot;);</span>
<span class="nc" id="L26">            printStream.println(&quot;Привееет, готовы поиграть в виселицу и повеселиться?&quot;);</span>
<span class="nc" id="L27">            printStream.println(&quot;Для продолжения введите - [y], иначе - [n]&quot;);</span>
            try {
<span class="nc" id="L29">                String ready = bufferedReader.readLine().toLowerCase();</span>
<span class="nc bnc" id="L30" title="All 2 branches missed.">                if(ready!= null){</span>
<span class="nc" id="L31">                    ready = ready.toLowerCase();</span>
                }else {
<span class="nc" id="L33">                    System.out.println(&quot;вы ничего не написали&quot;);</span>
                }
<span class="nc" id="L35">                Matcher matcherReady = CheckInputUserImpl.patternStartGame.matcher(ready);</span>

<span class="nc bnc" id="L37" title="All 2 branches missed.">                if (!matcherReady.find()) {</span>
<span class="nc" id="L38">                    printStream.println(&quot;Некорректный ввод, введите значение заново&quot;);</span>
<span class="nc" id="L39">                    ready = bufferedReader.readLine().toLowerCase();</span>
                }

<span class="nc bnc" id="L42" title="All 2 branches missed.">                if (CheckInputUserImpl.YES.equals(ready)) {</span>
<span class="nc" id="L43">                    printStream.println(&quot;------------------------------------------------------&quot;);</span>
<span class="nc" id="L44">                    printStream.println(&quot;Хотите выбрать категорию или доверитесь нам?&quot;);</span>
<span class="nc" id="L45">                    printStream.println(&quot;Возможные категории:&quot;);</span>

<span class="nc bnc" id="L47" title="All 2 branches missed.">                    for (String category : wordsGallows.getAllCategories()) {</span>
<span class="nc" id="L48">                        printStream.println(category);</span>
<span class="nc" id="L49">                    }</span>

<span class="nc" id="L51">                    printStream.println(&quot;Для выбора категории укажите первую букву [m/a/с]-, иначе нажмите - [n]&quot;);</span>
<span class="nc" id="L52">                    String answerCategory = bufferedReader.readLine().toLowerCase();</span>
<span class="nc" id="L53">                    Matcher matcherCategory = CheckInputUserImpl.patternCategory.matcher(answerCategory);</span>

<span class="nc bnc" id="L55" title="All 2 branches missed.">                    while (!matcherCategory.find()) {</span>
<span class="nc" id="L56">                        printStream.println(&quot;Некорректный ввод, введите значение заново&quot;);</span>
<span class="nc" id="L57">                        answerCategory = bufferedReader.readLine().toLowerCase();</span>
<span class="nc" id="L58">                        matcherCategory = CheckInputUserImpl.patternCategory.matcher(answerCategory);</span>
                    }

<span class="nc bnc" id="L61" title="All 2 branches missed.">                    if (CheckInputUserImpl.NO.equals(answerCategory)) {</span>
<span class="nc" id="L62">                        answerCategory = wordsGallows.getRandomCategory();</span>
                    }

<span class="nc" id="L65">                    printStream.println(&quot;------------------------------------------------------&quot;);</span>
<span class="nc" id="L66">                    printStream.println(&quot;Что насчет уровня сложности?&quot;);</span>
<span class="nc" id="L67">                    printStream.println(&quot;Для выбора уровня сложности укажите букву [e/m/h]-, иначе нажмите - [n]&quot;);</span>

<span class="nc" id="L69">                    String answerLevel = bufferedReader.readLine().toLowerCase();</span>
<span class="nc" id="L70">                    Matcher matcherLevel = CheckInputUserImpl.patternLevel.matcher(answerLevel);</span>

<span class="nc bnc" id="L72" title="All 2 branches missed.">                    while (!matcherLevel.find()) {</span>
<span class="nc" id="L73">                        printStream.println(&quot;Некорректный ввод, введите значение заново&quot;);</span>
<span class="nc" id="L74">                        answerLevel = bufferedReader.readLine().toLowerCase();</span>
<span class="nc" id="L75">                        matcherLevel = CheckInputUserImpl.patternLevel.matcher(answerLevel);</span>
                    }

<span class="nc bnc" id="L78" title="All 2 branches missed.">                    if (CheckInputUserImpl.NO.equals(answerLevel)) {</span>
<span class="nc" id="L79">                        answerLevel = wordsGallows.getRandomLevel();</span>
                    }

<span class="nc" id="L82">                    printStream.println(&quot;------------------------------------------------------&quot;);</span>

<span class="nc" id="L84">                    HashMap&lt;String, String&gt; gameWord = wordsGallows.getWord(answerCategory, answerLevel);</span>
<span class="nc" id="L85">                    String word = gameWord.keySet().stream().findFirst()</span>
<span class="nc" id="L86">                        .orElseThrow(() -&gt; new NoSuchElementException(&quot;Нет такого слова&quot;));</span>
<span class="nc" id="L87">                    String tip = gameWord.get(word);</span>

//                    Optional&lt;HashMap&lt;String, String&gt;&gt; optionalGameWord =
//                        Optional.ofNullable(wordsGallows.getWord(answerCategory, answerLevel));
//                    Optional&lt;String&gt; word = optionalGameWord.get().keySet().stream().findFirst();
//                    String tip = optionalGameWord.get().get(word.get());
<span class="nc" id="L93">                    SessionPlayer sessionPlayer = new SessionPlayer(word);</span>
<span class="nc" id="L94">                    printStream.println(&quot;Подготовили для вас слово&quot;);</span>
//                    printStream.println(word);

<span class="nc" id="L97">                    logicFindCorrectChar.checkChar(sessionPlayer, '_');</span>
<span class="nc" id="L98">                    printStream.println(sessionPlayer.currentEnter());</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">                    while (!(sessionPlayer.countAttempts &lt; 0)) {</span>
<span class="nc" id="L100">                        printStream.println(&quot;Если хотите подсказку, нажмите -[1], пропустить - пробел или любую букву&quot;);</span>

<span class="nc" id="L102">                        String userTip = bufferedReader.readLine().toLowerCase();</span>
<span class="nc" id="L103">                        Matcher matcherTip = CheckInputUserImpl.patternGetTip.matcher(userTip);</span>

<span class="nc bnc" id="L105" title="All 2 branches missed.">                        while (!matcherTip.find()) {</span>
<span class="nc" id="L106">                            printStream.println(&quot;Некорректный ввод&quot;);</span>
<span class="nc" id="L107">                            userTip = bufferedReader.readLine().toLowerCase();</span>
<span class="nc" id="L108">                            matcherTip = CheckInputUserImpl.patternGetTip.matcher(userTip);</span>
                        }

<span class="nc bnc" id="L111" title="All 2 branches missed.">                        if (CheckInputUserImpl.TIP.equals(userTip)) {</span>
<span class="nc" id="L112">                            printStream.println(&quot;Подсказка: &quot; + tip);</span>
                        }

<span class="nc" id="L115">                        int oldCountMatches = 0;</span>

<span class="nc" id="L117">                        printStream.println(&quot;У вас осталось - &quot; + sessionPlayer.countAttempts + &quot; попыток&quot;);</span>

<span class="nc bnc" id="L119" title="All 2 branches missed.">                        if (sessionPlayer.countAttempts == 0) {</span>
<span class="nc" id="L120">                            printStream.println(&quot;GAME OVER&quot;);</span>
<span class="nc" id="L121">                            break;</span>
                        }

<span class="nc" id="L124">                        printStream.println(&quot;Введите букву:&quot;);</span>
<span class="nc" id="L125">                        char[] enterLetter = bufferedReader.readLine().toLowerCase().toCharArray();</span>

<span class="nc bnc" id="L127" title="All 2 branches missed.">                        while (enterLetter.length != 1) {</span>
<span class="nc" id="L128">                            printStream.println(&quot;Некорректный ввод&quot;);</span>
<span class="nc" id="L129">                            enterLetter = bufferedReader.readLine().toLowerCase().toCharArray();</span>
                        }

<span class="nc" id="L132">                        logicFindCorrectChar.checkChar(sessionPlayer, enterLetter[0]);</span>

<span class="nc" id="L134">                        int countMatches = checkInputUser</span>
<span class="nc" id="L135">                            .equalsCharArray(sessionPlayer.currentEnter(), sessionPlayer.currentAnswer);</span>

<span class="nc bnc" id="L137" title="All 2 branches missed.">                        if (countMatches == oldCountMatches) {</span>
<span class="nc" id="L138">                            printStream.println(ImageGallows.IMAGES[sessionPlayer.countAttempts - 1]);</span>
<span class="nc" id="L139">                            sessionPlayer.countAttempts--;</span>
                        }

<span class="nc" id="L142">                        oldCountMatches = countMatches;</span>

<span class="nc" id="L144">                        printStream.println(sessionPlayer.currentAnswer());</span>

<span class="nc bnc" id="L146" title="All 2 branches missed.">                        if (checkInputUser.checkCorrectWord(sessionPlayer.currentAnswer(), word)) {</span>
<span class="nc" id="L147">                            printStream.println(&quot;ВЫ победили!!!!!!!!!!!&quot;);</span>
<span class="nc" id="L148">                            printStream.println(&quot;Загаданное слово - &quot; + word);</span>
<span class="nc" id="L149">                            break;</span>
                        }
<span class="nc" id="L151">                    }</span>
<span class="nc" id="L152">                } else {</span>
<span class="nc" id="L153">                    printStream.println(&quot;Закончили&quot;);</span>
<span class="nc" id="L154">                    break;</span>
                }
<span class="nc" id="L156">            } catch (IOException e) {</span>
<span class="nc" id="L157">                throw new RuntimeException(e);</span>
<span class="nc" id="L158">            }</span>
        }
<span class="nc" id="L160">    }</span>

    @SuppressWarnings(&quot;checkstyle:UncommentedMain&quot;)
    public static void main(String[] args) {

<span class="nc" id="L165">        GameInterface gameInterface = new GameInterface();</span>

<span class="nc" id="L167">        gameInterface.userInterface();</span>
<span class="nc" id="L168">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>